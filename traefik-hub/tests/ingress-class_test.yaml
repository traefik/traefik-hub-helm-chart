suite: IngressClass tests
release:
  name: traefik-hub
  namespace: traefik
templates:
  - ingress-class.yaml
tests:
  - it: should render default IngressClass
    asserts:
      - isKind:
          of: IngressClass
      - equal:
          path: metadata.name
          value: "traefik-hub"
      - isSubset:
          path: metadata.annotations
          content:
            ingressclass.kubernetes.io/is-default-class: "true"
      - equal:
          path: spec.controller
          value: hub.traefik.io/ingress-controller
  - it: should be possible to customize ingressclass
    set:
      providers:
        ingressClass:
          isDefaultClass: false
          name: "my-ing"
    asserts:
      - equal:
          path: metadata.name
          value: my-ing
      - isSubset:
          path: metadata.annotations
          content:
            ingressclass.kubernetes.io/is-default-class: "false"
  - it: should be possible to disable ingressclass
    set:
      providers:
        ingressClass:
          enabled: false
    asserts:
      - hasDocuments:
          count: 0
